<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Steve's Page</title>
  <link rel="stylesheet" href="steve1.css">
</head>
<body>
    <a href="../index.html">Go back to our Home Page...</a>
    <a href="../steve_smoke/smoking.html">Steve's Smoking Tracker...</a>
    <br><br>
  <header>
    <h1>Steve's Story Sparks</h1>
  </header>

  <main class="favorites">

    <div class="card" id="oracleCard">
      <p>Ironsworn</p>
      <button class="btnOracle" data-value="very likely">Very Likely</button>
      <button class="btnOracle" data-value="likely">Likely</button>
      <button class="btnOracle" data-value="50/50">50/50</button>
      <button class="btnOracle" data-value="unlikely">Unlikely</button>
      <button class="btnOracle" data-value="very unlikely">Very Unlikely</button>
      <p id="display_iron_oracle"></p>
      <button id="btnDetails">Details</button>
      <p id="display_iron_details"></p>
      <button id="btnOverland">Overland Travel</button>
      <p id="display_iron_overland"></p>
    </div>

    <div class="card" id="tarotCard">
      <p>Tarot</p>
      <button id="btnTarot">Draw a Card</button>
      <p id="displayTarot"></p>
    </div>
    
    <div class="card" id="card_animal_symbols">
      <p>Animal Symbols</p>
      <button id="btnAnimalSymbols">Draw an Animal</button>
      <p id="display_animal_symbols"></p>
    </div>
  </main>

  <script src="iron_action.js"></script>
  <script src="iron_descriptor.js"></script>
  <script src="iron_focus.js"></script>
  <script src="iron_theme.js"></script>
  <script src="iron_overland_landmark.js"></script>
  <script src="iron_overland_waypoint.js"></script>
  <script src="tarot.js"></script>
  <script src="animal_symbols.js"></script>
  
  <script>
    const iron_details_lists = [ironactionList, ironthemeList, irondescriptorList, ironfocusList];
    const iron_overland_lists = [ironoverlandwaypointList, ironoverlandlandmarkList];
    let displayTarot = document.getElementById('displayTarot');
    
    const dict_iron_oracle = {
      "very likely": 90,
      "likely": 75,
      "50/50": 50,
      "unlikely": 25,
      "very unlikely": 10
    }


    function btnIronDetails() {
      let results = [];

      for (let list of iron_details_lists) {
        const randomIndex = Math.floor(Math.random() * list.length);
        results.push(list[randomIndex]);
      }
      
      document.getElementById("display_iron_details").innerHTML = results.join(", ");
    }

    function btnIronOverland() {
      let results = [];

      for (let list of iron_overland_lists) {
        const randomIndex = Math.floor(Math.random() * list.length);
        results.push(list[randomIndex]);
      }
      
      document.getElementById("display_iron_overland").innerHTML = results.join("<br>");
    }


    function btnIronOracle(event) {
      const button = event.target;
      const choice = button.dataset.value;
      const target = dict_iron_oracle[choice];

      console.log(target)

      let d100 = Math.floor(Math.random() * 100) +1;
      console.log(d100)
      if (d100 <= target) {
        document.getElementById("display_iron_oracle").innerHTML = `Yes`;
      } else {
        document.getElementById("display_iron_oracle").innerHTML = `No`;
      }
    }

    function btnTarot(){
      // Get card direction
      const cardDirection = checkTarotCardDirection();
      // Get Random Suit
      const keys = Object.keys(tarot_cards);
      const randomIndex = Math.floor(Math.random() * keys.length);
      const randomKey = keys[randomIndex];
      const element = tarot_cards[randomKey]['suit element'];
      const suit = tarot_cards[randomKey]['suit'];
      const suitKeywords = tarot_cards[randomKey]['suit keywords'];
      const suitDuality = tarot_cards[randomKey]['suit duality'];
      const jung = tarot_cards[randomKey]['suit jung'];
      
      // Get Random Card from Suit
      const cardKeys = Object.keys(tarot_cards[randomKey]['cards']);
      const randomCardIndex = Math.floor(Math.random() * cardKeys.length);
      const randomCardKey = cardKeys[randomCardIndex];

      // Get Details from Card
      const uprightKeywords = tarot_cards[randomKey]['cards'][randomCardKey]['upright keywords'];
      const reversedKeywords = tarot_cards[randomKey]['cards'][randomCardKey]['reversed keywords'];
      const symbols = tarot_cards[randomKey]['cards'][randomCardKey]['symbols'];
      
      displayTarot.innerHTML = 
      `<b>${randomKey} (${element}, ${suitDuality}, ${jung})</b><br>` +
      `${suitKeywords}<br><br>`+
      `<b>${randomCardKey} (${cardDirection})</b><br><br>` +
      `Upright Keywords:<br>${uprightKeywords}<br><br>` +
      `Reversed Keywords:<br>${reversedKeywords}<br><br>` +
      `Symbols:<br>${symbols.join('<br>')}`
    }

    function checkTarotCardDirection(){
      const chosenOption = Math.random() > 0.5 ? "upright" : "reversed";
      return chosenOption;
    }

    function btnAnimalSymbol(){
      const randomIndex = Math.floor(Math.random() * animalSymbols.length);
      const randomItem = animalSymbols[randomIndex];
      document.getElementById("display_animal_symbols").innerHTML = randomItem;
    }

    // Listeners

    // Iron Oracle button
    document.querySelectorAll("#oracleCard .btnOracle").forEach(btn => {
      btn.addEventListener("click", btnIronOracle);
    });

    // Details button
    document.getElementById("btnDetails").addEventListener("click", btnIronDetails);

    // Overland button
    document.getElementById("btnOverland").addEventListener("click", btnIronOverland);

    // Tarot button
    document.getElementById('btnTarot').addEventListener("click", btnTarot);

    // Animal Symbol button
    document.getElementById('btnAnimalSymbols').addEventListener('click', btnAnimalSymbol);
  </script>
</body>
</html>
